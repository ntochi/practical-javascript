<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Todo List</title>
</head>
<body>
  <input type="text" id="add-input">
  <button id="add-button">
    Add Todo
  </button>

  <br>

  <input type="text" id="edit-position-input">
  <input type="text" id="edit-text-input">
  <button id="edit-button">
    Edit Todo
  </button>

  <br>

  <input type="text" id="toggle-position-input">
  <button id="toggle-button">
    Toggle A Todo
  </button>

  <br>

  <button id="toggle-all-button">
    Toggle All Todos
  </button>

  <br>

  <ul id="todo-list-ul">
  </ul>

  <script>
    var todos = [
      { text: 'Item 1', completed: false },
      { text: 'Item 2', completed: false },
      { text: 'Item 3', completed: false }
    ];

    displayTodos();

    function add() {
      var newTodo = addInput.value;
      todos.push({ text: newTodo, completed: false });
      addInput.value = '';
      displayTodos();
    }

    function edit() {
      var position = editPositionInput.value;
      var newValue = editTextInput.value;
      todos[position].text = newValue;
      editPositionInput.value = '';
      editTextInput.value = '';
      displayTodos();
    }

    function remove(event) {
      // event.target is the remove button we clicked on
      // eventListener function is passed as an event object, the event object has an event target property which in turn has an id.
      var positionId = event.target.id
      todos.splice(positionId, 1);
      displayTodos();
    }

    function toggle() {
      var position = togglePositionInput.value;

      if (todos[position].completed === true) {
        todos[position].completed = false;
      } else {
        todos[position].completed = true;
      }

      togglePositionInput.value = '';

      displayTodos()
    }

    function toggleAll() {
      // Find out if everything is true
      var completedTodos = 0;

      for (var i = 0; i < todos.length; i++) {
        if (todos[i].completed === true) {
          completedTodos++
        }
      }

      if (completedTodos === todos.length) {
        // If everything is true, change everything to false
        for (var i = 0; i < todos.length; i++){
          todos[i].completed = false;
        }
      } else {
        // If everything is false, change everything to true
        for (var i = 0; i < todos.length; i++){
          todos[i].completed = true;
        }
      }

      displayTodos();
    }

    function displayTodos() {
      var todoListUl = document.getElementById('todo-list-ul');
      todoListUl.innerHTML = '';

      for (var i = 0; i < todos.length; i++) {
        var newLi = document.createElement('li');

        // Create delete button, then apppend to lists
        var removeButton = document.createElement('button');
        removeButton.innerText = 'Delete';
        removeButton.addEventListener('click', remove);
        removeButton.id = i;

        // Mark/unmark completed todos
        if (todos[i].completed === true) {
          newLi.innerText = `[X] ${todos[i].text} `;
        } else {
          newLi.innerText = `[ ] ${todos[i].text} `;
        }

        newLi.appendChild(removeButton);

        todoListUl.appendChild(newLi);
      }
    }
  
    // Event listeners
    var addButton = document.getElementById('add-button');
    var addInput = document.getElementById('add-input');
    addButton.addEventListener('click', add);

    var editButton = document.getElementById('edit-button');
    var editPositionInput = document.getElementById('edit-position-input');
    var editTextInput = document.getElementById('edit-text-input');
    editButton.addEventListener('click', edit);

    var toggleButton = document.getElementById('toggle-button');
    var togglePositionInput = document.getElementById('toggle-position-input');
    toggleButton.addEventListener('click', toggle);

    var toggleAllButton = document.getElementById('toggle-all-button');
    toggleAllButton.addEventListener('click', toggleAll);
  </script>
</body>
</html>